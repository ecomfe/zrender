<html>
<head>
	<meta charset="utf8" />
	<title>Animation</title>
	<script type="text/javascript" src="js/esl.js"></script>
</head>
<body>
	<script type="text/javascript">
		require.config({
            paths: {
                'js': 'js/js'
            }
        });
		require(["../src/zrender",
				"../src/animation/animation"], function(zrender, Animation){
			
			// 初始化zrender
			var zr = zrender.init( document.getElementById("Main") );
			var circle = {
							shape : 'circle',
						    id : zr.newShapeId(),
						    translate : [20, 20],
						    style : {
						    	x : 0,
						    	y : 0,
						        r : 50,
						        brushType : 'both',
						        color : 'rgba(220, 20, 60, 0.8)',
						        strokeColor : "rgba(220, 20, 60, 0.8)",   
						        lineWidth : 5,
						        text :'circle',
						        textPosition :'inside'
						    },
						    draggable : true
						}
			zr.addShape( circle );
			zr.render();

			var anim = new Animation(),
				renderer = {
					// 这里做一个简单的适配
					// render函数在animation设置了start之后每一次刷新都会触发
					// 也可以不使用animation的start函数
					// 手动每一帧去调用update函数更新状态
					render : function(){
						zr.modShape( circle.id, circle );
						zr.refresh();
					}
				}
			anim.stage = renderer;
			anim.start();

			anim.animate( circle )
				.when(1000, {
					translate : [200, 0]
				})
				.when(2000, {
					translate : [200, 200]
				}, "BounceIn")
				.when(3000, {
					translate : [0, 200]
				})
				.when(4000, {
					translate : [100, 100]
				})
				.done(function(){
					// alert("animation finished")
					console.log(circle.translate);
				})

			anim.animate( circle.style )
				.when( 1000, {
					r : 100
				})
				.when( 2000, {
					r : 50
				})
				.when( 3000, {
					r : 30
				})
				.start()
		})
	</script>
	<div id="Main" style="width:600px;height:400px;"></div>
</body>
</html>